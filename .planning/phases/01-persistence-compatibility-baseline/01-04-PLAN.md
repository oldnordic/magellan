---
phase: 01-persistence-compatibility-baseline
plan: 04
type: execute
wave: 4
depends_on: [01-03]
files_modified:
  - .planning/ROADMAP.md
  - .planning/REQUIREMENTS.md
  - .planning/phases/01-persistence-compatibility-baseline/01-persistence-compatibility-baseline-VERIFICATION.md
autonomous: true
gap_closure: true
must_haves:
  truths:
    - "Phase 1 contract docs (ROADMAP + REQUIREMENTS) are consistent with the implemented sqlitegraph baseline: v1.0.0 pinned from crates.io with reproducible resolution via Cargo.lock."
    - "Phase 1 verification report reflects the (consistent) contract and shows 4/4 truths verified with no remaining doc-mismatch gaps."
  artifacts:
    - path: ".planning/ROADMAP.md"
      provides: "Phase 1 success criteria and plan list aligned to crates.io sqlitegraph pin + completion state"
      contains: "sqlitegraph v1.0.0"
    - path: ".planning/REQUIREMENTS.md"
      provides: "DB-01 requirement aligned to crates.io pin (local override optional, not contract-required)"
      contains: "DB-01"
    - path: ".planning/phases/01-persistence-compatibility-baseline/01-persistence-compatibility-baseline-VERIFICATION.md"
      provides: "Updated Phase 1 verification report with no DB-01 local-checkout gap"
      contains: "score: 4/4"
  key_links:
    - from: ".planning/REQUIREMENTS.md"
      to: ".planning/ROADMAP.md"
      via: "DB-01 wording ↔ Phase 1 success criteria truth #1"
      pattern: "DB-01"
    - from: ".planning/phases/01-persistence-compatibility-baseline/01-persistence-compatibility-baseline-VERIFICATION.md"
      to: ".planning/REQUIREMENTS.md"
      via: "requirements coverage table"
      pattern: "DB-01"
---

<objective>
Ensure Phase 1 contract docs (ROADMAP/REQUIREMENTS) and the Phase 1 verification report are mutually consistent with the implemented, reproducible sqlitegraph baseline (crates.io v1.0.0 + committed Cargo.lock).

Purpose: Phase 1 intentionally pins sqlitegraph v1.0.0 from crates.io for reproducibility. This plan does not assume requirements must change; it enforces consistency across docs and verification by removing any stale/local-checkout phrasing if present and re-asserting evidence.
Output: Updated docs (if needed for consistency) + updated Phase 1 verification report (reflecting the consistent contract).
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/01-persistence-compatibility-baseline/01-persistence-compatibility-baseline-VERIFICATION.md
@.planning/phases/01-persistence-compatibility-baseline/01-01-SUMMARY.md
@.planning/phases/01-persistence-compatibility-baseline/01-02-SUMMARY.md
@.planning/phases/01-persistence-compatibility-baseline/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Align Phase 1 contract docs (ROADMAP + REQUIREMENTS) to crates.io sqlitegraph baseline</name>
  <files>
.planning/ROADMAP.md
.planning/REQUIREMENTS.md
  </files>
  <action>
Ensure Phase 1 wording is internally consistent with the implemented and recorded Phase 1 decisions/summaries (minimal edits; no intent change):

1) Update `.planning/REQUIREMENTS.md`
- Ensure **DB-01** states the contract-required behavior that is implemented and desired:
  - sqlitegraph is pinned to **v1.0.0** from **crates.io**
  - dependency resolution is reproducible (Cargo.lock tracked)
  - local checkout override is OPTIONAL (developer convenience) via `[patch.crates-io]` or `path = ...`, but is not required for satisfying DB-01.
- If any leftover wording requires a specific local checkout path (e.g., `/home/feanor/Projects/sqlitegraph`), remove/reword it for consistency.
- Update the Traceability row for DB-01 (Phase 1) only insofar as needed to keep it consistent with the above.

2) Update `.planning/ROADMAP.md`
- Ensure Phase 1 success criteria truth #1 matches the crates.io pin + reproducible resolution wording.
- Ensure the Phase 1 plan list checkboxes reflect actual completion (01-01/01-02/01-03 should be checked).
- (Optional but recommended for consistency) Ensure the Phase 1 plan 01 label text matches what plan 01 actually did (pin crates.io v1.0.0 + lockfile), not “use local checkout”.

Do NOT change Phase 2+ wording; this is a Phase 1 consistency check only.
  </action>
  <verify>
- Confirm docs now state crates.io pin (not local path):
  - Search `.planning/ROADMAP.md` for `/home/feanor/Projects/sqlitegraph` under Phase 1 (it should no longer be part of the success criteria).
  - Search `.planning/REQUIREMENTS.md` DB-01 section for the same path (it should no longer be contract-required).
  </verify>
  <done>
- DB-01 requirement no longer requires a specific local checkout path.
- Phase 1 success criteria truth #1 in ROADMAP matches the chosen approach (crates.io pin + reproducible lockfile).
- ROADMAP Phase 1 plan checklist reflects reality (all Phase 1 plans checked).
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Phase 1 verification report to reflect the corrected contract and re-assert evidence</name>
  <files>.planning/phases/01-persistence-compatibility-baseline/01-persistence-compatibility-baseline-VERIFICATION.md</files>
  <action>
Update the Phase 1 verification report to reflect the (now-consistent) Phase 1 contract and evidence:

- In frontmatter:
  - Set `status: verified` (or equivalent) since there should be no gaps after contract alignment.
  - Set `score: 4/4 must-haves verified`.
  - Remove the `gaps:` entry (or set it to an empty list) because the only gap was contract wording.

- In the “Observable Truths” table:
  - Replace truth #1 text with the new Phase 1 success criterion wording.
  - Mark truth #1 as VERIFIED and add evidence based on actual repository state (Cargo.toml/Cargo.lock + cargo tree).

- In “Requirements Coverage”:
  - Mark DB-01 as satisfied (since it now matches the implemented approach).

Then re-assert the evidence with actual commands:
- Run `cargo tree -i sqlitegraph` and confirm sqlitegraph resolves to v1.0.0 from crates.io registry.
- Run `cargo test --workspace` to ensure Phase 1 baseline remains green.

Capture the relevant command outputs (brief excerpts) in the verification report evidence fields.
  </action>
  <verify>
- `cargo tree -i sqlitegraph` shows sqlitegraph v1.0.0 from crates.io.
- `cargo test --workspace` passes.
- Verification report frontmatter shows `status: verified` and `score: 4/4`.
  </verify>
  <done>
- Phase 1 verification report has no remaining gaps.
- Truth #1 and DB-01 are consistent across ROADMAP, REQUIREMENTS, and VERIFICATION artifacts.
  </done>
</task>

</tasks>

<verification>
- Doc consistency check: ROADMAP Phase 1 success criteria, REQUIREMENTS DB-01, and Phase 1 VERIFICATION truth #1 all describe the same behavior.
- Build sanity: `cargo test --workspace` remains green.
</verification>

<success_criteria>
- Phase 1 contract docs and verification report are consistent with each other (no doc-mismatch gaps).
- Phase 1 verification report shows 4/4 truths verified.
</success_criteria>

<output>
After completion, create `.planning/phases/01-persistence-compatibility-baseline/01-04-SUMMARY.md`.
</output>
